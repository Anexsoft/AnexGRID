function anexGrid_boton(a){a={contenido:void 0!=a.contenido?a.contenido:"","class":void 0!=a["class"]?a["class"]:"",style:void 0!=a.style?a.style:"",attr:void 0!=a.attr?a.attr:[],type:void 0!=a.type?a.type:"button",value:void 0!=a.value?a.value:""};var t="";return $.each(a.attr,function(a,n){t+=n}),a.attr=t,'<button type="'+a.type+'" style="'+a.style+'" class="btn '+a["class"]+'" value="'+a.value+'" '+a.attr+">"+a.contenido+"</button>"}function anexGrid_link(a){a={contenido:void 0!=a.contenido?a.contenido:"","class":void 0!=a["class"]?a["class"]:"",style:void 0!=a.style?a.style:"",attr:void 0!=a.attr?a.attr:[],href:void 0!=a.href?a.href:"_self",target:void 0!=a.target?a.target:""};var t="";return $.each(a.attr,function(a,n){t+=n}),a.attr=t,'<a href="'+a.href+'" target="'+a.target+'" class="'+a["class"]+'" '+a.attr+">"+a.contenido+"</a>"}function anexGrid_dropdown(a){a={contenido:void 0!=a.contenido?a.contenido:"","class":void 0!=a["class"]?a["class"]:"",style:void 0!=a.style?a.style:"",attr:void 0!=a.attr?a.attr:[],id:void 0!=a.id?a.id:"",data:void 0!=a.data?a.data:[]};var t="";$.each(a.attr,function(a,n){t+=n}),a.attr=t;var n='<button id="'+a.id+'" style="'+a.style+'" class="btn '+a["class"]+'" type="button" '+a.attr+' data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">'+a.contenido+' <span class="caret"></span></button>',i='<ul class="dropdown-menu" aria-labelledby="'+a.id+'">';return $.each(a.data,function(a,t){i+='<li><a href="'+t.href+'">'+t.contenido+"</a></li>"}),i+="</ul>",'<div class="dropdown">'+n+i+"</div>"}function anexGrid_input(a){a={"class":void 0!=a["class"]?a["class"]:"",style:void 0!=a.style?a.style:"",attr:void 0!=a.attr?a.attr:[],type:void 0!=a.type?a.type:"text",value:void 0!=a.value?a.value:""};var t="";return $.each(a.attr,function(a,n){t+=n}),a.attr=t,'<input type="'+a.type+'" style="'+a.style+'" class="form-control input-sm '+a["class"]+'" value="'+a.value+'" '+a.attr+" />"}function anexGrid_imagen(a){a={"class":void 0!=a["class"]?a["class"]:"",style:void 0!=a.style?a.style:"",attr:void 0!=a.attr?a.attr:[],src:void 0!=a.src?a.src:""};var t="";return $.each(a.attr,function(a,n){t+=n}),a.attr=t,'<img src="'+a.src+'" class="'+a["class"]+'" style="'+a.style+'" '+a.attr+"/>"}function anexGrid_select(a){a={"class":void 0!=a["class"]?a["class"]:"",style:void 0!=a.style?a.style:"",attr:void 0!=a.attr?a.attr:[],selected:void 0!=a.selected?a.selected:"",data:void 0!=a.data?a.data:[]};var t="";$.each(a.attr,function(a,n){t+=n}),a.attr=t;var n=$('<select style="'+a.style+'" class="form-control input-sm '+a["class"]+'" '+a.attr+"></select>");return $.each(a.data,function(t,i){n.append("<option "+(i.valor==a.selected?"selected":"")+' value="'+i.valor+'">'+i.contenido+"</option>")}),n}$.fn.anexGrid=function(a){function t(){var a=y.tabla.find("."+h.columnas);a.html("<tr></tr>"),y.filtrable&&a.append('<tr class="'+h.filtro+'"></tr>'),$(y.columnas).each(function(a,t){var n=$('<th class="'+r(t["class"],"")+'" style="'+r(t.style,"")+'"></th>');if(t.ordenable){var i=$('<a href="#" class="'+h.columna_ordenar+'" data-columna="'+r(t.columna,"")+'"></a>');i.html(t.leyenda),n.html(i)}else n.text(t.leyenda);if(y.tabla.find("thead tr:first").append(n),y.filtrable){if(n=$("<th></th>"),void 0!=t.filtro)if("function"==typeof t.filtro){var o=$(t.filtro());if(o.attr("data-columna",t.columna).removeClass("input-sm input-lg").addClass("input-sm").addClass(h.filtro_control),$(o).is("input")){var l=$('<div class="input-group"><div class="'+h.filtro_control_container+'"></div><span class="input-group-btn"><button class="btn btn-default btn-sm '+h.filtro_limpiar+'" type="button">Go!</button></span>'),e='<i class="glyphicon glyphicon-remove"></i>';l.find("."+h.filtro_control_container).html(o),l.find("."+h.filtro_limpiar).html(e),n.html(l)}$(o).is("select")&&n.html(o)}else if(t.filtro){var o=$(anexGrid_input({}));o.attr("data-columna",t.columna).removeClass("input-sm input-lg").addClass("input-sm").addClass(h.filtro_control);var l=$('<div class="input-group"><div class="'+h.filtro_control_container+'"></div><span class="input-group-btn"><button title="'+v.filtro_limpiar+'" class="btn btn-default btn-sm '+h.filtro_limpiar+'" type="button">Go!</button></span>'),e='<i class="glyphicon glyphicon-remove"></i>';l.find("."+h.filtro_control_container).html(o),l.find("."+h.filtro_limpiar).html(e),n.html(l)}y.tabla.find("thead tr."+h.filtro).append(n)}})}function n(){0==y.data.length&&y.tabla.find("."+h.filas).html('<tr><td colspan="'+y.columnas.length+'" class="text-center">'+v.no_encontrados+"</td></tr>"),$(y.data).each(function(a,t){var n=$('<tr data-fila="'+a+'" class="'+h.fila+a+'"></tr>');$(y.modelo).each(function(a,i){var l=$('<td class="'+r(i["class"],"")+'" style="'+r(i.style,"")+'"></td>'),e="";void 0!=i.propiedad&&(e=i.propiedad.indexOf(".")>-1?o(t,i.propiedad):t[i.propiedad]),void 0!=i.formato?l.html(i.formato(n,t,e)):l.text(e),n.append(l)}),y.tabla.find("."+h.filas).append(n)}),m(!1),f(!1),y.cargarPaginacion()}function i(){if(y.paginable){var a=y.tabla.find("."+h.paginador);if(a.data("cargado"))d(),a.find("."+h.paginador_paginas).text(y.paginas),a.find("."+h.paginador_registros_encontrados).html(p()),a.find("."+h.paginador_pagina_actual).val(y.pagina),g(!1);else{d(),a.html("");var t=$('<tr class="active"></tr>');t.html('<td colspan="'+y.columnas.length+'" style="height:40px;line-height:30px;"></td>');var n="";n="number"!=typeof y.limite?'<div class="col-xs-3">'+v.registros_mostrando+' <select style="width:80px;display:inline-block;" class="form-control input-sm '+h.paginador_paginas_por_pagina+'">'+u()+"</select></div>":'<div class="col-xs-3">'+v.registros_mostrando+" "+y.porPagina+" "+v.registros+"</div>";var i='<div class="col-xs-6 text-center"><i title="'+v.primera_pagina+'" style="font-size:0.8em;cursor:pointer;" class="glyphicon glyphicon-step-backward '+h.paginador_primero+'"></i><i title="'+v.anterior_pagina+'" style="font-size:0.8em;margin-right:4px;cursor:pointer;" class="glyphicon glyphicon-backward '+h.paginador_anterior+'"></i> '+l(v.pagina)+' <input class="text-center form-control input-sm '+h.paginador_pagina_actual+'" type="text" value="'+y.pagina+'" style="width:50px;display:inline-block;" /> / <b class="'+h.paginador_paginas+'">'+y.paginas+'</b> <i title="'+v.siguiente_pagina+'" style="font-size:0.8em;margin-left:4px;cursor:pointer;" class="glyphicon glyphicon-forward '+h.paginador_siguiente+'"></i><i title="'+v.ultima_pagina+'" style="font-size:0.8em;cursor:pointer;" class="glyphicon glyphicon-step-forward '+h.paginador_final+'"></i></div>',o='<div class="col-xs-3 text-right '+h.paginador_registros_encontrados+'">'+p()+"</div>";t.find("td").html('<div style="margin:0;" class="row">'+n+i+o+"</div>"),a.html(t).attr("data-cargado",!0)}}}function o(a,t){var n=t.split(".");if(n.length>1){var i="";return $.each(n,function(a,t){a>0&&(i+=t+(n.length-2==a?".":""))}),o(a[n[0]],i)}return a[n[0]]}function r(a,t){return void 0===a?t:a}function l(a){return a.charAt(0).toUpperCase()+a.slice(1)}function e(a){return parseInt(a)?!0:!1}function s(a){y.filtros.length>0?$.each(y.filtros,function(t,n){n.columna==a.columna?(y.filtros[t].columna=a.columna,y.filtros[t].valor=a.valor):t==y.filtros.length-1&&y.filtros.push(a)}):y.filtros.push(a)}function c(a){var t=[];$.each(y.filtros,function(n,i){i.columna!=a&&t.push(i)}),y.filtros=t}function d(){y.paginas=Math.ceil(y.total/y.porPagina)}function p(){return v.registro_encontrados.replace("{t}",y.total).replace("{r}",0==y.total||y.total>1?v.registros:v.registro)}function u(){var a="";return $.each(y.limite,function(t,n){a+='<option value="'+n+'">'+n+"</option>"}),a}function g(a){y.tabla.find("."+h.paginador_pagina_actual).attr("disabled",a),y.tabla.find("."+h.paginador_paginas_por_pagina).attr("disabled",a),y.tabla.find("."+h.paginador_primero).attr("disabled",a),y.tabla.find("."+h.paginador_anterior).attr("disabled",a),y.tabla.find("."+h.paginador_siguiente).attr("disabled",a),y.tabla.find("."+h.paginador_final).attr("disabled",a)}function f(a){y.tabla.find("."+h.filtro_control).attr("disabled",a)}function m(a){y.tabla.find("."+h.columnas+" a").attr("disabled",a)}var v={error_cargando:"Ocurrio un error al cargar la data.",filtro_limpiar:"Retirar filtro",paginas:"páginas",pagina:"página",primera_pagina:"Primera página",ultima_pagina:"Página final",anterior_pagina:"Página anterior",siguiente_pagina:"Página siguiente",registro_encontrados:"Se han encontrado {t} {r}",registros:"registros",registro:"registro",registros_mostrando:"Por página:",encontrados:"encontrados",no_encontrados:"Sin registros que mostrar",cargando:".. cargando .."},_="anexgrid-"+this.attr("id").replace("#",""),h={columnas:_+"-columnas",filas:_+"-filas",filtro:_+"-filtro",filtro_control_container:_+"-filtro-control-container",filtro_control:_+"-filtro-control",filtro_limpiar:_+"-filtro-limpiar",paginador:_+"-paginador",paginador_pagina_actual:_+"-paginador-pagina-actual",paginador_paginas_por_pagina:_+"-paginador-por-pagina",paginador_paginas:_+"-paginador-paginas",paginador_registros_encontrados:_+"-paginador-registros-encontrados",paginador_siguiente:_+"-paginador-siguiente",paginador_final:_+"-paginador-final",paginador_anterior:_+"-paginador-anterior",paginador_primero:_+"-paginador-primero",columna_ordenar:_+"-columna-ordenar",fila:_+"-fila-"},y={"class":r(a["class"],""),style:r(a.style,""),columnas:a.columnas,modelo:a.modelo,url:a.url,type:r(a.type,"POST"),dataType:r(a.dataType,"JSON"),data:[],parametros:r(a.parametros,{}),columna:a.columna,columna_orden:a.columna_orden,columna_defecto:a.columna,columna_defecto_orden:a.columna_orden,pagina:1,paginas:1,total:0,limite:r(a.limite,20),porPagina:0,paginable:r(a.paginable,!1),filtrable:r(a.filtrable,!1),filtros:[],tabla:null,creaGrilla:function(){y.tabla=$('<table id="'+_+'" style="'+y.style+'" class="table '+y["class"]+'"><thead class="'+h.columnas+'"><tr></tr></thead><tbody class="'+h.filas+'"></tbody><tfoot class="'+h.paginador+'"></tfoot></table>'),y.porPagina="number"==typeof y.limite?y.limite:y.limite[0]},cargarColumnas:function(){t()},cargarData:function(){g(!0),f(!0),m(!0);var a=y.tabla.find("."+h.filas);a.css("opacity",.4);var t={limite:y.porPagina,pagina:y.pagina,columna:y.columna,columna_orden:y.columna_orden,filtros:y.filtros,parametros:y.parametros};$.ajax({dataType:y.dataType,type:y.type,url:y.url,data:t,success:function(t){a.html("").css("opacity",1),y.data=t.data,y.total=t.total,n()},error:function(t,n,i){g(!1),f(!1),m(!1),a.html('<tr class="danger"><td colspan="'+y.columnas.length+'" class="danger text-center">'+v.error_cargando+"</td></tr>"),console.log(i+" | "+n)}})},obtener:function(a){return y.data[a]},cargarPaginacion:function(){i()}};return y.creaGrilla(),y.cargarColumnas(),y.cargarData(),this.html(y.tabla),y.tabla.on("click","."+h.columna_ordenar,function(){var a=$(this);if(a.attr("disabled"))return!1;$(".glyphicon",a.closest("tr")).remove(),y.pagina=1;var t=$('<i style="margin-left:4px;font-size:0.8em;" class=""></i>');return y.columna!=a.data("columna")&&(y.columna=a.data("columna"),y.columna_orden=""),""==y.columna_orden?(y.columna_orden="ASC",t.attr("class","glyphicon glyphicon-chevron-up"),a.append(t)):"ASC"==y.columna_orden?(y.columna_orden="DESC",t.attr("class","glyphicon glyphicon-chevron-down"),a.append(t)):"DESC"==y.columna_orden&&(y.columna_orden="",y.columna=y.columna_defecto,y.columna_orden=y.columna_orden),y.cargarData(),!1}),y.tabla.on("keyup","."+h.filtro_control,function(a){var t=$(this);13==a.keyCode&&(s({columna:t.data("columna"),valor:t.val()}),y.pagina=1,y.cargarData())}),y.tabla.on("change","."+h.filtro_control,function(){var a=$(this);a.is("select")&&(a.find("option:selected").index()>0?s({columna:a.data("columna"),valor:a.val()}):c(a.data("columna")),y.pagina=1,y.cargarData())}),y.tabla.on("click","."+h.filtro_limpiar,function(){var a=$(this).closest(".input-group").find("."+h.filtro_control);a.val(""),c(a.data("columna")),y.pagina=1,y.cargarData()}),y.tabla.on("keyup","."+h.paginador_pagina_actual,function(a){if(13==a.keyCode){if(!e($(this).val()))return void $(this).val(y.pagina);if($(this).val()==y.pagina)return;if($(this).val()>y.paginas)return;if(0==$(this).val())return;y.pagina=$(this).val(),y.cargarData()}}),y.tabla.on("focus","."+h.paginador_pagina_actual,function(){$(this).val("")}),y.tabla.on("change","."+h.paginador_paginas_por_pagina,function(){y.pagina=1,y.porPagina=$(this).val(),y.cargarData()}),y.tabla.on("click","."+h.paginador_primero,function(){$(this).attr("disabled")||e(y.pagina)&&1!=$("."+h.paginador_pagina_actual).val()&&(y.pagina=1,y.cargarData())}),y.tabla.on("click","."+h.paginador_anterior,function(){$(this).attr("disabled")||e(y.pagina)&&1!=$("."+h.paginador_pagina_actual).val()&&(y.pagina-=1,y.cargarData())}),y.tabla.on("click","."+h.paginador_final,function(){$(this).attr("disabled")||e(y.pagina)&&$("."+h.paginador_pagina_actual).val()!=y.paginas&&(y.pagina=y.paginas,y.cargarData())}),y.tabla.on("click","."+h.paginador_siguiente,function(){$(this).attr("disabled")||e(y.pagina)&&$("."+h.paginador_pagina_actual).val()!=y.paginas&&(y.pagina+=1,y.cargarData())}),{total:function(){return y.total},tabla:function(){return y.tabla},refrescar:function(){return y.pagina=1,y.cargarData()},parametros:function(a){y.parametros=a},obtener:function(a){return y.obtener(a)}}};