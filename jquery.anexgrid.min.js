function anexGrid_boton(a){a={contenido:void 0!==a.contenido?a.contenido:"","class":void 0!==a["class"]?a["class"]:"",style:void 0!==a.style?a.style:"",attr:void 0!==a.attr?a.attr:[],type:void 0!==a.type?a.type:"button",value:void 0!==a.value?a.value:""};var t="";return $.each(a.attr,function(a,n){t+=n}),a.attr=t,'<button type="'+a.type+'" style="'+a.style+'" class="btn '+a["class"]+'" value="'+a.value+'" '+a.attr+">"+a.contenido+"</button>"}function anexGrid_link(a){a={contenido:void 0!==a.contenido?a.contenido:"","class":void 0!==a["class"]?a["class"]:"",style:void 0!==a.style?a.style:"",attr:void 0!==a.attr?a.attr:[],href:void 0!==a.href?a.href:"_self",target:void 0!==a.target?a.target:""};var t="";return $.each(a.attr,function(a,n){t+=n}),a.attr=t,'<a href="'+a.href+'" target="'+a.target+'" class="'+a["class"]+'" '+a.attr+">"+a.contenido+"</a>"}function anexGrid_dropdown(a){a={contenido:void 0!==a.contenido?a.contenido:"","class":void 0!==a["class"]?a["class"]:"",style:void 0!==a.style?a.style:"",attr:void 0!==a.attr?a.attr:[],id:void 0!==a.id?a.id:"",data:void 0!==a.data?a.data:[]};var t="";$.each(a.attr,function(a,n){t+=n}),a.attr=t;var n='<button id="'+a.id+'" style="'+a.style+'" class="btn '+a["class"]+'" type="button" '+a.attr+' data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">'+a.contenido+' <span class="caret"></span></button>',i='<ul class="dropdown-menu" aria-labelledby="'+a.id+'">';return $.each(a.data,function(a,t){i+='<li><a href="'+t.href+'">'+t.contenido+"</a></li>"}),i+="</ul>",'<div class="dropdown">'+n+i+"</div>"}function anexGrid_input(a){a={"class":void 0!==a["class"]?a["class"]:"",style:void 0!==a.style?a.style:"",attr:void 0!==a.attr?a.attr:[],type:void 0!==a.type?a.type:"text",value:void 0!==a.value?a.value:""};var t="";return $.each(a.attr,function(a,n){t+=n}),a.attr=t,'<input type="'+a.type+'" style="'+a.style+'" class="form-control input-sm '+a["class"]+'" value="'+a.value+'" '+a.attr+" />"}function anexGrid_imagen(a){a={"class":void 0!==a["class"]?a["class"]:"",style:void 0!==a.style?a.style:"",attr:void 0!==a.attr?a.attr:[],src:void 0!==a.src?a.src:""};var t="";return $.each(a.attr,function(a,n){t+=n}),a.attr=t,'<img src="'+a.src+'" class="'+a["class"]+'" style="'+a.style+'" '+a.attr+"/>"}function anexGrid_select(a){a={"class":void 0!==a["class"]?a["class"]:"",style:void 0!==a.style?a.style:"",attr:void 0!==a.attr?a.attr:[],selected:void 0!==a.selected?a.selected:"",data:void 0!==a.data?a.data:[]};var t="";$.each(a.attr,function(a,n){t+=n}),a.attr=t;var n=$('<select style="'+a.style+'" class="form-control input-sm '+a["class"]+'" '+a.attr+"></select>");return $.each(a.data,function(t,i){n.append("<option "+(i.valor==a.selected?"selected":"")+' value="'+i.valor+'">'+i.contenido+"</option>")}),n}$.fn.anexGrid=function(a){"use strict";function t(){var a=P.tabla.find("."+x.columnas);a.html("<tr></tr>"),P.filtrable&&a.append('<tr class="'+x.filtro+'"></tr>'),$(P.columnas).each(function(a,t){var n=_(o(t.style,"")),i=$('<th class="'+o(t["class"],"")+'" style="'+n+'"></th>');if(P.columnas_ancho.push(i.css("width")),t.leyenda=o(t.leyenda,""),void 0!==t.formato?i.html(t.formato()):i.text(t.leyenda),t.ordenable){var r=$('<a href="#" class="'+x.columna_ordenar+'" data-columna="'+o(t.columna,"")+'"></a>');r.html(i.html()),i.html(r)}if(P.tabla.find("thead tr:first").append(i),P.filtrable){if(i=$("<th></th>"),void 0!==t.filtro)if("function"==typeof t.filtro){var l=$(t.filtro());if(l.attr("data-columna",t.columna).removeClass("input-sm input-lg").addClass("input-sm").addClass(x.filtro_control),$(l).is("input")){var e=$('<div class="input-group"><div class="'+x.filtro_control_container+'"></div><span class="input-group-btn"><button class="btn btn-default btn-sm '+x.filtro_limpiar+'" type="button">Go!</button></span>'),s='<i class="glyphicon glyphicon-remove"></i>';e.find("."+x.filtro_control_container).html(l),e.find("."+x.filtro_limpiar).html(s),i.html(e)}$(l).is("select")&&i.html(l)}else if(t.filtro){var l=$(anexGrid_input({}));l.attr("data-columna",t.columna).removeClass("input-sm input-lg").addClass("input-sm").addClass(x.filtro_control);var e=$('<div class="input-group"><div class="'+x.filtro_control_container+'"></div><span class="input-group-btn"><button title="'+y.filtro_limpiar+'" class="btn btn-default btn-sm '+x.filtro_limpiar+'" type="button">Go!</button></span>'),s='<i class="glyphicon glyphicon-remove"></i>';e.find("."+x.filtro_control_container).html(l),e.find("."+x.filtro_limpiar).html(s),i.html(e)}P.tabla.find("thead tr."+x.filtro).append(i)}})}function n(){0===P.data.length&&P.tabla.find("."+x.filas).html('<tr><td colspan="'+P.columnas.length+'" class="text-center">'+y.sin_registros+"</td></tr>");var a=P.tabla.find("."+x.filas);$(P.data).each(function(t,n){var i=$('<tr data-fila="'+t+'" class="'+x.fila+t+'"></tr>');$(P.modelo).each(function(a,t){var l=_(o(t.style,"")),e=$('<td class="'+o(t["class"],"")+'" style="'+l+'"></td>'),s="";void 0!==t.propiedad&&(s=t.propiedad.indexOf(".")>-1?r(n,t.propiedad):n[t.propiedad]),void 0!==t.formato?e.html(t.formato(i,n,s)):e.text(s),i.append(e)}),a.append(i)}),v(!1),m(!1),P.cargarPaginacion()}function i(){var a=P.tabla.find("."+x.paginador);if(d(),a.data("cargado"))h()||(a.find("."+x.paginador_paginas).text(P.paginas),a.find("."+x.paginador_registros_encontrados).html(g()),a.find("."+x.paginador_pagina_actual).val(P.pagina)),f(!1);else{if(a.html(""),h())P.contenedor.append('<select class="form-control input-lg '+x.paginador_responsive+'"></select>');else{var t=$('<tr class="active"></tr>');if(t.html('<td colspan="'+P.columnas.length+'" style="height:40px;line-height:30px;"></td>'),P.paginable){var n="";n="number"!=typeof P.limite?'<div class="col-xs-3">'+y.registros_mostrando+' <select style="width:80px;display:inline-block;" class="form-control input-sm '+x.paginador_paginas_por_pagina+'">'+u()+"</select></div>":'<div class="col-xs-3">'+y.registros_mostrando+" "+P.porPagina+" "+y.registros+"</div>";var i='<div class="col-xs-6 text-center"><i title="'+y.primera_pagina+'" style="font-size:0.8em;cursor:pointer;" class="glyphicon glyphicon-step-backward '+x.paginador_primero+'"></i><i title="'+y.anterior_pagina+'" style="font-size:0.8em;margin-right:4px;cursor:pointer;" class="glyphicon glyphicon-backward '+x.paginador_anterior+'"></i> '+l(y.pagina)+' <input class="text-center form-control input-sm '+x.paginador_pagina_actual+'" type="text" value="'+P.pagina+'" style="width:50px;display:inline-block;" /> / <b class="'+x.paginador_paginas+'">'+P.paginas+'</b> <i title="'+y.siguiente_pagina+'" style="font-size:0.8em;margin-left:4px;cursor:pointer;" class="glyphicon glyphicon-forward '+x.paginador_siguiente+'"></i><i title="'+y.ultima_pagina+'" style="font-size:0.8em;cursor:pointer;" class="glyphicon glyphicon-step-forward '+x.paginador_final+'"></i></div>',r='<div class="col-xs-3 text-right '+x.paginador_registros_encontrados+'">'+g()+"</div>";t.find("td").html('<div style="margin:0;" class="row">'+n+i+r+"</div>")}else t.find("td").addClass("text-center "+x.paginador_registros_encontrados).html(g())}a.html(t).attr("data-cargado",!0)}p()}function r(a,t){var n=t.split(".");if(n.length>1){var i="";return $.each(n,function(a,t){a>0&&(i+=t+(n.length-2==a?".":""))}),r(a[n[0]],i)}return a[n[0]]}function o(a,t){return void 0===a?t:a}function l(a){return a.charAt(0).toUpperCase()+a.slice(1)}function e(a){return parseInt(a)?!0:!1}function s(a){P.filtros.length>0?$.each(P.filtros,function(t,n){n.columna==a.columna?(P.filtros[t].columna=a.columna,P.filtros[t].valor=a.valor):t==P.filtros.length-1&&P.filtros.push(a)}):P.filtros.push(a)}function c(a){var t=[];$.each(P.filtros,function(n,i){i.columna!=a&&t.push(i)}),P.filtros=t}function d(){P.paginas=Math.ceil(P.total/P.porPagina)}function p(){if(h()){var a=P.contenedor.find("."+x.paginador_responsive);a.html("");for(var t=1;t<=P.paginas;t++){var n=$('<option value="'+t+'">'+t+" / "+P.paginas+"</option>");t===P.pagina&&n.attr("selected",!0),a.append(n)}}}function g(){return y.registro_encontrados.replace("{t}",P.total).replace("{r}",0==P.total||P.total>1?y.registros:y.registro)}function u(){var a="";return $.each(P.limite,function(t,n){a+='<option value="'+n+'">'+n+"</option>"}),a}function f(a){P.tabla.find("."+x.paginador_pagina_actual).attr("disabled",a),P.tabla.find("."+x.paginador_paginas_por_pagina).attr("disabled",a),P.tabla.find("."+x.paginador_primero).attr("disabled",a),P.tabla.find("."+x.paginador_anterior).attr("disabled",a),P.tabla.find("."+x.paginador_siguiente).attr("disabled",a),P.tabla.find("."+x.paginador_final).attr("disabled",a),P.contenedor.find("."+x.paginador_responsive).attr("disabled",a)}function m(a){P.tabla.find("."+x.filtro_control).attr("disabled",a)}function v(a){P.tabla.find("."+x.columnas+" a").attr("disabled",a)}function _(a){var t="";if("object"==typeof a)for(var n in a)t+=n+":"+a[n]+";";else t=a;return t}function h(){return navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/)}a.lang=void 0!==a.lang?a.lang:{};var y={error_cargando:o(a.lang.error_cargando,"Ocurrio un error al cargar la data."),filtro_limpiar:o(a.lang.filtro_limpiar,"Retirar filtro"),paginas:o(a.lang.paginas,"páginas"),pagina:o(a.lang.pagina,"páginas"),primera_pagina:o(a.lang.primera_pagina,"Primera página"),ultima_pagina:o(a.lang.ultima_pagina,"Página final"),anterior_pagina:o(a.lang.anterior_pagina,"Página anterior"),siguiente_pagina:o(a.lang.anterior_pagina,"Página siguiente"),registro_encontrados:o(a.lang.anterior_pagina,"Se han encontrado {t} {r}"),registros:o(a.lang.registros,"registros"),registro:o(a.lang.registro,"registro"),registros_mostrando:o(a.lang.registros_mostrando,"Por página:"),encontrados:o(a.lang.encontrados,"encontrados"),sin_registros:o(a.lang.encontrados,"Sin registros que mostrar"),cargando:o(a.lang.cargando,".. cargando ..")},b="anexgrid-"+this.attr("id").replace("#",""),x={columnas:b+"-columnas",filas:b+"-filas",filtro:b+"-filtro",filtro_control_container:b+"-filtro-control-container",filtro_control:b+"-filtro-control",filtro_limpiar:b+"-filtro-limpiar",paginador:b+"-paginador",paginador_pagina_actual:b+"-paginador-pagina-actual",paginador_paginas_por_pagina:b+"-paginador-por-pagina",paginador_paginas:b+"-paginador-paginas",paginador_registros_encontrados:b+"-paginador-registros-encontrados",paginador_responsive:b+"-paginador-responsive",paginador_siguiente:b+"-paginador-siguiente",paginador_final:b+"-paginador-final",paginador_anterior:b+"-paginador-anterior",paginador_primero:b+"-paginador-primero",columna_ordenar:b+"-columna-ordenar",columna_ordenar_control:b+"-columna-ordenar-control",fila:b+"-fila-"},P={"class":o(a["class"],""),style:o(a.style,""),columnas:a.columnas,columnas_ancho:[],modelo:a.modelo,url:a.url,type:o(a.type,"POST"),dataType:o(a.dataType,"JSON"),data:[],parametros:o(a.parametros,{}),columna:a.columna,columna_orden:a.columna_orden,columna_defecto:a.columna,columna_defecto_orden:a.columna_orden,pagina:1,paginas:1,total:0,limite:o(a.limite,20),porPagina:0,paginable:o(a.paginable,!1),filtrable:o(a.filtrable,!1),filtros:[],responsive:o(a.responsive,!1),tabla:null,contenedor:this,creaGrilla:function(){P.tabla=$('<table id="'+b+'" style="'+P.style+'" class="table '+P["class"]+'"><thead class="'+x.columnas+'"><tr></tr></thead><tbody class="'+x.filas+'"></tbody><tfoot class="hidden-xs hidden-sm '+x.paginador+'"></tfoot></table>'),P.porPagina="number"==typeof P.limite?P.limite:P.limite[0]},cargarColumnas:function(){t()},cargarData:function(){f(!0),m(!0),v(!0);var a=P.tabla.find("."+x.filas);a.css("opacity",.4);var t={limite:P.porPagina,pagina:P.pagina,columna:P.columna,columna_orden:P.columna_orden,filtros:P.filtros,parametros:P.parametros};$.ajax({dataType:P.dataType,type:P.type,url:P.url,data:t,success:function(t){a.html("").css("opacity",1),P.data=t.data,P.total=t.total,n()},error:function(t,n,i){f(!1),m(!1),v(!1),a.html('<tr class="danger"><td colspan="'+P.columnas.length+'" class="danger text-center">'+y.error_cargando+"</td></tr>"),console.log(i+" | "+n)}})},obtener:function(a){return P.data[a]},cargarPaginacion:function(){i()}};P.creaGrilla(),P.cargarColumnas(),P.cargarData();var k=$('<div class="table-responsive" />');return k.html(P.tabla),P.contenedor.html(k),P.tabla.on("click","."+x.columna_ordenar,function(){var a=$(this);if(a.attr("disabled"))return!1;$("."+x.columna_ordenar_control,a.closest("tr")).remove(),P.pagina=1;var t=$('<i style="margin-left:4px;font-size:0.8em;" class=""></i>');return P.columna!=a.data("columna")&&(P.columna=a.data("columna"),P.columna_orden=""),""==P.columna_orden?(P.columna_orden="ASC",t.attr("class","glyphicon glyphicon-chevron-up "+x.columna_ordenar_control),a.append(t)):"ASC"==P.columna_orden?(P.columna_orden="DESC",t.attr("class","glyphicon glyphicon-chevron-down "+x.columna_ordenar_control),a.append(t)):"DESC"==P.columna_orden&&(P.columna_orden="",P.columna=P.columna_defecto,P.columna_orden=P.columna_orden),P.cargarData(),!1}),P.tabla.on("keyup","."+x.filtro_control,function(a){var t=$(this);13==a.keyCode&&(s({columna:t.data("columna"),valor:t.val()}),P.pagina=1,P.cargarData())}),P.tabla.on("change","."+x.filtro_control,function(a){var t=$(this);t.is("select")&&(t.find("option:selected").index()>0?s({columna:t.data("columna"),valor:t.val()}):c(t.data("columna")),P.pagina=1,P.cargarData())}),P.tabla.on("click","."+x.filtro_limpiar,function(a){var t=$(this).closest(".input-group").find("."+x.filtro_control);t.val(""),c(t.data("columna")),P.pagina=1,P.cargarData()}),P.tabla.on("keyup","."+x.paginador_pagina_actual,function(a){if(13==a.keyCode){if(!e($(this).val()))return void $(this).val(P.pagina);if($(this).val()==P.pagina)return;if($(this).val()>P.paginas)return;if(0===$(this).val())return;P.pagina=parseInt($(this).val()),P.cargarData()}}),P.tabla.on("focus","."+x.paginador_pagina_actual,function(a){$(this).val("")}),P.tabla.on("change","."+x.paginador_paginas_por_pagina,function(){P.pagina=1,P.porPagina=parseInt($(this).val()),P.cargarData()}),P.tabla.on("click","."+x.paginador_primero,function(){$(this).attr("disabled")||e(P.pagina)&&1!=$("."+x.paginador_pagina_actual).val()&&(P.pagina=1,P.cargarData())}),P.tabla.on("click","."+x.paginador_anterior,function(){$(this).attr("disabled")||e(P.pagina)&&1!=$("."+x.paginador_pagina_actual).val()&&(P.pagina-=1,P.cargarData())}),P.tabla.on("click","."+x.paginador_final,function(){$(this).attr("disabled")||e(P.pagina)&&$("."+x.paginador_pagina_actual).val()!=P.paginas&&(P.pagina=P.paginas,P.cargarData())}),P.tabla.on("click","."+x.paginador_siguiente,function(){$(this).attr("disabled")||e(P.pagina)&&$("."+x.paginador_pagina_actual).val()!=P.paginas&&(P.pagina+=1,P.cargarData())}),P.contenedor.on("change","."+x.paginador_responsive,function(){P.pagina=parseInt($(this).val()),P.cargarData()}),{total:function(){return P.total},tabla:function(){return P.tabla},refrescar:function(){return P.pagina=1,P.cargarData()},parametros:function(a){P.parametros=a},obtener:function(a){return P.obtener(a)}}};
